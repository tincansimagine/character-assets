# 깡피소 캐릭터 에셋 확장 (Character Assets Extension)

> **이 확장은 디시인사이드 비공갤 깡갤 대피소에서 배포됐으며, 다른 곳에 해당 확장에 대해 소개할 때는 반드시 출처를 표기해주시길 바랍니다.**
> 
> **깡갤 대피소 주소: https://gall.dcinside.com/mini/tincans**

이 확장은 SillyTavern에서 대화 응답에 맥락에 맞는 이미지를 자동으로 삽입할 수 있게 해주는 기능을 제공합니다.

## 주요 기능

- 캐릭터 전용 이미지 에셋 관리
- 대화 맥락에 맞는 이미지 자동 삽입
- AI 모델의 롤플레잉 응답과 통합된 이미지 표시
- 다양한 이미지 형식 지원 (PNG, JPEG, GIF, WEBP)
- 캐릭터별 맞춤 설정 가능
- 자동 키워드 갱신 기능
- 캐릭터 실제 폴더명 참조 기능
- 다양한 이미지 디스플레이 스타일 지원

## 사용 방법

### 1. 이미지 에셋 추가

캐릭터를 위한 이미지 에셋을 추가하는 방법은 두 가지가 있습니다:

- **개별 이미지 업로드**: "이미지 업로드" 버튼을 클릭하고 이미지 파일을 선택합니다. 파일명이 키워드로 사용됩니다.
- **ZIP 파일 업로드**: 여러 이미지가 담긴 ZIP 파일을 업로드합니다. 파일명이 키워드로 사용됩니다.

### 2. 이미지 키워드 선택

업로드한 이미지 중 대화에 사용할 이미지를 체크박스로 선택합니다. 선택된 이미지만 대화 중에 사용됩니다.

### 3. 프롬프트 설정

대화 프롬프트에 다음 플레이스홀더를 추가하여 이미지 기능을 활성화합니다:

- `{{img_inprompt}}`: 이미지 출력 프롬프트 전체가 이 위치에 삽입됩니다.
- `{{img_keywords}}`: 선택된 모든 이미지 키워드가 쉼표로 구분되어 이 위치에 삽입됩니다.
- `{{img_keywords_autogen}}`: 자동으로 갱신되는 이미지 파일명 목록입니다. 캐릭터 변경/에셋 업로드/삭제 시 자동으로 갱신됩니다.
- `{{charkey}}`: 현재 캐릭터의 실제 저장 폴더명입니다(예: Ian2, Luna3). 동일한 이름의 캐릭터가 여러 개 있을 때 유용합니다.

### 4. 이미지 표시 스타일 선택

이미지 표시 방법을 다양한 스타일 중에서 선택할 수 있습니다:

- **기본형**: 둥근 사각형 스타일
- **테두리형**: 테두리와 그림자가 있는 스타일
- **깔끔형**: 투명 배경 스타일
- **그림자형**: 강한 그림자 효과가 있는 스타일
- **폴라로이드**: 사진 프레임 스타일

각 스타일은 "이미지 표시 스타일 선택" 섹션에서 미리보기를 확인하고 다운로드할 수 있습니다.

### 5. 정규식 설정

이미지 태그 변환을 위한 정규식은 선택한 스타일에 따라 자동으로 다운로드됩니다:

- **찾을 패턴**: AI가 생성한 이미지 태그를 찾기 위한 정규식 패턴 (`{{img::filename.ext}}` 형식)
- **바꿀 내용**: 찾은 태그를 실제 이미지로 변환하기 위한 HTML/CSS (선택한 스타일에 따라 다름)

## 이미지 파일 네이밍 규칙

이미지 파일명은 키워드로 직접 사용됩니다. 한 키워드에 여러 이미지를 추가하려면 다음과 같은 형식을 사용하세요:

- 기본: `키워드.확장자` (예: `joy.png`)
- 변형 1: `키워드-숫자.확장자` (예: `joy-1.png`, `joy-2.png`)
- 변형 2: `키워드.설명.확장자` (예: `joy.expressive.png`, `joy.excited.png`)

## 슬래시 명령어

- `/assets-upload label=키워드 URL`: URL에서 이미지를 다운로드하여 지정된 키워드로 업로드합니다.

## 팁

- 이미지 출력 프롬프트는 AI가 대화 맥락에 맞는 이미지를 선택하는 방법을 설명합니다. 필요에 따라 수정할 수 있습니다.
- 프리셋 기능을 사용하여 자주 사용하는 프롬프트를 저장하고 불러올 수 있습니다.
- `{{img_keywords_autogen}}` 플레이스홀더를 사용하면 키워드 목록을 수동으로 업데이트할 필요가 없습니다.
- `{{charkey}}` 매크로를 사용하면 동일한 이름의 캐릭터가 여러 개 있을 때도 정확한 폴더를 참조할 수 있습니다.
- 갤러리 기능을 사용하여 모든 에셋 이미지를 한눈에 확인할 수 있습니다.
- 키워드 검색 필터를 사용하여 많은 에셋 중에서 원하는 키워드를 빠르게 찾을 수 있습니다.

## 주의사항

- 이 확장은 현재 그룹 채팅을 지원하지 않습니다.
- 너무 많은 이미지를 사용하면 토큰 소비가 증가할 수 있습니다.
- 모든 AI 모델이 HTML 태그를 정확히 생성하지 않을 수 있습니다. 
 ㄴ 예를 들어, 모델이 `<img src="keyword">`와 같이 확장자를 포함하지 않고 응답을 출력할 경우, 엑스박스가 뜰 수 있습니다. 반드시 확장자도 함께 포함돼야 합니다.
 ㄴ 올바른 예시: `<img src="joy-expressive.png">`